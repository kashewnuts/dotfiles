# プランを docs に出力

プランファイルの内容をプロジェクトの `docs/` ディレクトリに整形して出力する。

## 入力

`$ARGUMENTS` には以下のいずれかを指定:
- 出力ファイル名 (例: `feature_design.md`)
- 空の場合はプランのタイトルから自動生成

## 処理手順

1. **プランファイルの検出**
   - `~/.claude/plans/` ディレクトリから最新のプランファイルを検出
   - または、会話中でアクティブなプランファイルを使用

2. **プラン内容の読み込み**
   - プランファイル (.md) を読み込む
   - タイトル（H1）を抽出

3. **ドキュメント用に整形**
   - 以下のセクションを **除外**:
     - 「実装手順」「実装ステップ」
     - 「検証方法」（簡略化して残す場合あり）
     - 「次のステップ」「TODO」
   - 以下のセクションを **保持**:
     - 「概要」「目的」
     - 「現状分析」「背景」
     - 「設計」「アーキテクチャ」
     - 「推奨アプローチ」
     - 「注意事項」「制約」

4. **出力ファイル名の決定**
   - `$ARGUMENTS` が指定されている場合はそれを使用
   - 未指定の場合: タイトルをスネークケースに変換 (例: `feature_xyz_design.md`)

5. **docs/ ディレクトリへの出力**
   - `docs/` ディレクトリが存在しない場合は作成
   - 整形したドキュメントを出力

## 出力フォーマット

```markdown
# [プランのタイトル]

> このドキュメントは Claude Code のプランから自動生成されました。
> 生成日: YYYY-MM-DD

## 概要

[プランの概要セクション]

---

## 背景・現状分析

[現状分析セクション]

---

## 設計・アプローチ

[設計/推奨アプローチセクション]

---

## 注意事項

[注意事項セクション]

---

## 参考

- 元プランファイル: `~/.claude/plans/xxx.md`
```

## 整形ルール

1. **セクション順序の正規化**
   - 概要 → 背景 → 設計 → 注意事項 の順に並べ替え

2. **技術的詳細の調整**
   - コマンド例は保持（参考情報として有用）
   - 具体的なファイルパスは保持

3. **不要な情報の除去**
   - Bash コマンドの実行手順（ステップバイステップ）
   - チェックボックス形式の TODO リスト
   - 「完了」「済」などのステータス表記

## 注意事項

- プランファイルが見つからない場合はエラーメッセージを表示
- 既存ファイルがある場合は上書き確認を行う
- Git 管理下の場合は変更をステージングしない（ユーザーに任せる）
